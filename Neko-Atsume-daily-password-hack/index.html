<!8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Zhaoyuan Ma"><meta name="description" content="&lt;img align=&quot;left&quot; style=&quot;padding-right:1em&quot; src=&quot;/img/neko/65535.jpg&quot;&gt;Fool some cats to earn &quot;a little bit&quot; more daily reward.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;"><meta name="keywords" content="Hack,Web develop"><title>Neko Atsume daily password hack · Zhaoyuan Ma</title><!--link(rel="icon", href=url_for(theme.favicon))--><link rel="canonical" href="http://zhyma.github.io/Neko-Atsume-daily-password-hack/"><link rel="alternate" href="/atom.xml" title="Zhaoyuan Ma"><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><link rel="stylesheet" href="/css/style.css"><script type="text/javascript">var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?Your baidu Analytics ID";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'Your Google Analytics ID', 'auto');
ga('send', 'pageview');</script></head><body><div id="main"><header><a href="/." class="logo">Zhaoyuan Ma</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">Home</a></li><li class="nav-link"><a href="/categories/" target="_self">Categories</a></li><li class="nav-link"><a href="/tags/" target="_self">Tags</a></li><li class="nav-link"><a href="/about/" target="_self">About</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">Neko Atsume daily password hack</h1><span class="post-time">Apr 21, 2016</span><div class="post-content"><p>For people who play Neko Atsume (a Tamagochi game), saving fish (the currency in that game) can a real pain. But I’m not going to install a cracked version from unknown source for unlimited fish, nor spend money on In-App purchasing. I need to find another way.</p>
<p>This game provides a daily password system, which may have some hidden flaw. You get into the menu, find the daily password, input it, and then receive some fish. Just like this.</p>
<p><img src="/img/neko/secretary.jpg" alt=""></p>
<p>If you have multiple devices, you will find the password is the same on different devices. And you will obtain the same amount of fish as well. That means devices get the password from the same approach, send the input to the server to get verified, received the same response (if you input correct password).</p>
<p>First thing first, setup an AP (Access Point) to intercept data flow between the game and the server. This was done by using a Raspberry Pi. Remembered to turn off data access on your phone to ensure that all data went through Wi-Fi. Here shows how the topology of the network changes. </p>
<div style="display:inline-block;text-align:center;"><br><img src="/img/neko/net1.jpg" alt=""><br><em>Up: Original network topology<br>Down: Insert a interceptor into the network</em><br></div>

<p>Then turned on Wireshark to capture data flow. I set the Wi-Fi hotspot of Pi as 192.168.2.1. The phone was allocated as 192.168.2.92. Opened the app, clicked “info”, input password, and received fish.<br>Here came some interesting data with the keyword “neko”.</p>
<p><img src="/img/neko/daily.jpg" alt=""></p>
<p>Data was sent to 49.212.146.33, which is equal to <a href="http://hpmobile.jp/" target="_blank" rel="noopener">http://hpmobile.jp/</a>. The full URL was <a href="http://hpmobile.jp/app/nekoatsume/neko_daily_en.php" target="_blank" rel="noopener">http://hpmobile.jp/app/nekoatsume/neko_daily_en.php</a>. Data obtained from the web page was “1,Insect,19,0,2016-04-19,”. “Insect” was the password of date “2016 April, 19th”. If you input that password, you would be rewarded with 19 silver fish and 0 golden fish.</p>
<p>Then moved along the timeline. Here was another URL: <a href="http://hpmobile.jp/app/nekoatsume/neko_aikotoba_en.php?aiko=insect&amp;sn=300&amp;gn=10" target="_blank" rel="noopener">http://hpmobile.jp/app/nekoatsume/neko_aikotoba_en.php?aiko=insect&amp;sn=300&amp;gn=10</a>.</p>
<p><img src="/img/neko/input.jpg" alt=""></p>
<p>Our submission used the password you input as the parameter for “aiko” to fulfill the post method.<br>Then the respond here was:</p>
<p><img src="/img/neko/output.jpg" alt=""></p>
<p>This web page returned “2,2016-04-19,19,0,”. If you tried to input a wrong password, it would be sent to the same PHP page. And “0” would be the respond. There wouldn’t be any effect if you changed “sn=” or “gn=”.</p>
<p>What we discovered was pretty promising. Next step was to <a href="http://andrewmichaelsmith.com/2013/08/raspberry-pi-wi-fi-honeypot/" target="_blank" rel="noopener">modify the Pi into a honeypot</a> to redirect the process locally and feed the app with fake web pages.</p>
<div style="display:inline-block;text-align:center;"><br><img src="/img/neko/net2.jpg" alt=""><br><em>Redirect data flow to a fake server</em><br></div>

<p>I installed Nginx and PHP, created two pages called “neko_daily_en.php” and “neko_aikotoba_en.php” under “/var/www<strong>/app/nekoatsume/</strong>”. The content of “neko_daily_en.php” was “1,test,65535,65535,2016-04-21,”, while the content of “neko_aikotoba_en.php” was “2,2016-04-21,65535,65535,”.<br>If you saw this, cats are fooled!</p>
<p><img src="/img/neko/test.jpg" alt=""></p>
<p>Since our PHP page didn’t check the input, just typed whatever you want.</p>
<p><img src="/img/neko/65535.jpg" alt=""></p>
<p>Is that what you are looking for?</p>
<p>Other findings:</p>
<ol>
<li>The number of fish in “neko_daily_en.php” is not used in the whole process. Only data in “neko_aikotoba_en.php” matters.</li>
<li>The app will restore the date of the last check-in, and compare with the server to see whether you have already checked in that day. So just changing date information inside “neko_aikotoba_en.php” will be fine to avoid this check.</li>
<li>The content of PHP page should end with “,”. Otherwise, the app cannot recognize the number of golden fish.</li>
</ol>
</div></article><div class="tags"><a href="/tags/Hack/">Hack</a><a href="/tags/Web-develop/">Web develop</a></div><div class="paginator"><a href="/Robot-learning-from-observation/" class="prev"><i class="iconfont icon-left"></i><span> Prev</span></a><a href="/Touch-typing-on-touch-cover/" class="next"><span>Next</span><i class="iconfont icon-right"></i></a></div></section><footer><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2012-2020<span class="at"> @ </span><span class="author">Zhaoyuan Ma</span></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></body></html>